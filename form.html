<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/sweetalert2@7.12.15/dist/sweetalert2.min.css'>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <style>
        .form {
            position: relative
        }
        .form .fa-search {
            position: absolute;
            top: 15px;
            left: 20px;
            color: gray
        }
        .form-input {
            height: 45px;
            text-indent: 33px;
            border-radius: 10px;
            margin-top: 5px;
            margin-bottom: 5px;
        }
        .form-control:focus {
            box-shadow: none;
        }

        .form-select:focus {
            box-shadow: none;
        }

        .wajib:after {
            content:" *";
            color: red;
        }
    </style>
    <title>Hero Form</title>
</head>

<body>
    <!-- Pembuatan navbar atas -->
    <nav class="navbar d-flex" style="background-color: rgba(0,0,0,.9); color: white;">
        <img src="logo.png" class="d-inline-block align-top" alt="Logo" style="margin-left: 40px;">
        <h4 style="display: inline-flex; margin-left: 35px;"><b>Heroes</b></h4>
        <div class="flex-fill d-none d-md-block" style="margin-left: 40px;">
            <div class="form"> <i class="fa fa-search"></i> <input type="text" class="form-control form-input" placeholder="Search Hero Names" id="cari">  </div>
        </div>
        <a href="https://play.google.com/store/apps/details?id=com.ngame.allstar.eu&hl=in&gl=US" style="margin-left: 40px; margin-right: 40px;"><img src="download.jpg" alt="Download" height="60"></a>  
    </nav>
    
    <!-- Pembuatan text besar di tengah layar -->
    <div style="margin-top: 30px; margin-bottom: 60px; text-align: center;">
        <h1 class="fw-bold">New Hero</h1>
    </div>
    <div class="container my-2">   
        <!-- Formulir create hero -->
        <form>
            <input type="hidden" id="id_hero" name="id_hero" value="">
            <div class="row mb-3">
                <label for="art" class="col-sm-2 col-form-label wajib">Splash Art Image</label>
                <div class="col-sm-10">
                    <input type="file" class="form-control" id="art" name="art" accept="image/jpg" required>
                </div>
            </div>
            <div class="row mb-3">
                <label for="nama_hero" class="col-sm-2 col-form-label wajib">Hero Name</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="nama_hero" name="nama_hero" required>
                </div>
            </div>
            <div class="row mb-3">
                <label for="role" class="col-sm-2 col-form-label wajib">Role</label>
                <div class="col-sm-10">
                    <select class="form-control" name="role" id="role" required>
                        <option value="" selected>-</option>
                    </select>
                </div>
            </div>
            <div class="row mb-3">
                <label for="skill1_name" class="col-sm-2 col-form-label wajib">1st Skill Name</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="skill1_name" name="skill1_name" required>
                </div>
            </div>
            <div class="row mb-3">
                <label for="skill1_desc" class="col-sm-2 col-form-label wajib">1st Skill Description</label>
                <div class="col-sm-10">
                    <textarea class="form-control" name="skill1_desc" id="skill1_desc" required></textarea>
                </div>
            </div>
            <div class="row mb-3">
                <label for="skill2_name" class="col-sm-2 col-form-label wajib">2nd Skill Name</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="skill2_name" name="skill2_name" required>
                </div>
            </div>
            <div class="row mb-3">
                <label for="skill2_desc" class="col-sm-2 col-form-label wajib">2nd Skill Description</label>
                <div class="col-sm-10">
                    <textarea class="form-control" name="skill2_desc" id="skill2_desc" required></textarea>
                </div>
            </div>
            <div class="row mb-3">
                <label for="ulti_name" class="col-sm-2 col-form-label wajib">Ultimate Name</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="ulti_name" name="ulti_name" required>
                </div>
            </div>
            <div class="row mb-3">
                <label for="ulti_desc" class="col-sm-2 col-form-label wajib">Ultimate Description</label>
                <div class="col-sm-10">
                    <textarea class="form-control" name="ulti_desc" id="ulti_desc" required></textarea>
                </div>
            </div>
            <div class="row mb-3">
                <div class="offset-sm-2 col-sm-10">
                    <button type="submit" class="btn btn-primary">Submit</button>
                    <a href="index.html" class="btn btn-outline-secondary">Back</a>
                </div>
            </div>
        </form>
    </div>

    <!-- Pembuatan footer dan navbar bawah -->
    <footer>
        <nav class="navbar footer mt-5" style="background-color: #e3f2fd;">
            <!-- karena ada karakter unik &copy perlu span agar bisa berubah jadi simbol -->
            <span class="navbar-text mx-auto"> 
                &copy Copyright 2022 | Martin Chandra
            </span>
        </nav>
    </footer>

    <script>
        $(document).ready(function() {
            $.get("role.php", function (response) {
                $.each(response, function (key, value) {
                    $("#role").append("<option value='"+value.id_role+"'>"+value.role_name+"</option>");
                    
                });

                var params = window.location.search.substr(1).split('&');
                for (var i = 0; i < params.length; i++) {
                    params[i] = params[i].split('=');
                }
                if (params[0][0] == "action" && params[0][1] == "update") {
                    $.get("hero.php?action=detail&id_hero="+ params[1][1], function(response) {
                        $("h1").html("Update Data Hero");
                        $("form #id_hero").val(response.id_hero);
                        $("form #nama_hero").val(response.nama_hero);
                        $("form #role").val(response.role);
                        $("form #skill1_name").val(response.skill1_name);
                        $("form #skill1_desc").html(response.skill1_desc);
                        $("form #skill2_name").val(response.skill2_name);
                        $("form #skill2_desc").html(response.skill2_desc);
                        $("form #ulti_name").val(response.ulti_name);
                        $("form #ulti_desc").html(response.ulti_desc);
                    })
                }

                $("form").submit(function (event) {
                    event.preventDefault();
                    // var data = $(this).serialize();
                    var data = new FormData(this);
                    if (params[0][0] == "action" && params[0][1] == "update") {
                        $.ajax ({
                            url         : "hero.php?action=update",
                            type        : "POST",
                            data        : data,
                            contentType : false,
                            cache       : false,
                            processData : false,
                            success     : function(response) {
                                alert("Data Hero berhasil diubah!");
                                window.location.href = 'index.html';
                            }
                        });
                       
                    } else {
                        $.ajax ({
                            url         : "hero.php?action=create",
                            type        : "POST",
                            data        : data,
                            contentType : false,
                            cache       : false,
                            processData : false,
                            success     : function(response) {
                                alert("Data Hero berhasil ditambahkan!");
                                window.location.href = 'index.html';
                            }
                        });
                    }
                });
            });
        });
    </script>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script src="https://use.fontawesome.com/9784a2957b.js"></script>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
</body>
</html>